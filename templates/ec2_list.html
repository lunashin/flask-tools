<html>

<head>

    <style type="text/css">
        .running{ color: #40bd19; font-weight:bolder; }
        .stopped{ color: #bebebe; }
        .other{ color: #ef9d5a; }
        .btn-terminate{ background: #e96b6b;}
    </style>

</head>

<body>

<h1>EC2</h1>
{{ date_str_now }} æ›´æ–°
<br>

<h2>Running</h2>
<table border=1>
    <tr>
        <th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å</th>
        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
        <th>ã‚¿ã‚¤ãƒ—</th>
        <th>ğŸŒPublic IP</th>
        <th>Private IP</th>
        <th>åœæ­¢</th>
    </tr>
    {% for item in running_list %}
    <tr>
        <td>{{ item.name }}</td>
        <td class="{% if item.state == 'running' %}running{% else %}stopped{% endif %}">{{ item.state }}</td>
        <td>{{ item.instance_type}}</td>
        <td>{{ item.public_ip }}</td>
        <td>{{ item.private_ip }}</td>
        <td> <input type="button" onclick="ec2_stop('{{ item.name }}', '{{ item.instance_id }}')" value="Stop"> </td>
    </tr>
    {% endfor %}
</table>

<h2>Stopped</h2>
<table border=1>
    <tr>
        <th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å</th>
        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
        <th>ã‚¿ã‚¤ãƒ—</th>
        <th>ğŸŒPublic IP</th>
        <th>Private IP</th>
        <th>èµ·å‹•/å‰Šé™¤</th>
    </tr>
    {% for item in stopped_list %}
    <tr>
        <td>{{ item.name }}</td>
        <td class="{% if item.state == 'running' %}running{% else %}stopped{% endif %}">{{ item.state }}</td>
        <td>{{ item.instance_type}}</td>
        <td>{{ item.public_ip }}</td>
        <td>{{ item.private_ip }}</td>
        <td>
            <input type="button" onclick="ec2_start('{{ item.instance_id }}')" value="Start">
            <input type="button" onclick="ec2_change_instance_type('{{ item.instance_id }}')" value="Change Type">
            <input type="button" class="btn-terminate" onclick="ec2_terminate('{{ item.name }}', '{{ item.instance_id }}')" value="Terminate">
        </td>
    </tr>
    {% endfor %}
</table>

<h2>Other</h2>
<table border=1>
    <tr>
        <th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å</th>
        <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
        <th>ã‚¿ã‚¤ãƒ—</th>
        <th>ğŸŒPublic IP</th>
        <th>Private IP</th>
    </tr>
    {% for item in other_list %}
    <tr>
        <td>{{ item.name }}</td>
        <td class="other">{{ item.state }}</td>
        <td>{{ item.instance_type}}</td>
        <td>{{ item.public_ip }}</td>
        <td>{{ item.private_ip }}</td>
    </tr>
    {% endfor %}
</table>


<br>
<input type="button" onclick="ec2_create_template()" value="Create(ã„ã¤ã‚‚ã®)">




<script>

    // ï¼‘åˆ†æ¯ã«ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
    setTimeout("location.href=location.href",60*1000);

    // Send EC2 Create
    function ec2_create_template()
    {
        let yesno = window.confirm('ã„ã¤ã‚‚ã®è¨­å®šã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ');
        
        if (yesno) {
            let name = window.prompt("ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", "");
            fetch("/aws/create_template?name=" + name);
            setTimeout("location.href=location.href",1000);
        }
    }

    // Send EC2 Start
    function ec2_start(instance_id)
    {
        fetch("/aws/start?instance_id=" + instance_id);
        setTimeout("location.href=location.href",500);
    }

    // Send EC2 Stop
    function ec2_stop(name, instance_id)
    {
        let yesno = window.confirm(name + ' / ' + instance_id + 'ã‚’åœæ­¢ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ');

        if (yesno) {
            fetch("/aws/stop?instance_id=" + instance_id);
            setTimeout("location.href=location.href",500);
        }
    }

    // Send EC2 Terminate
    function ec2_terminate(name, instance_id)
    {
        let yesno = window.confirm(name + ' / ' + instance_id + 'ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\n\næ³¨æ„: ã“ã®æ“ä½œã¯æˆ»ã›ã¾ã›ã‚“ã€‚');

        if (yesno) {
            fetch("/aws/terminate?instance_id=" + instance_id);
            setTimeout("location.href=location.href",500);
        }
    }

    // EC2 Start/Stop Action
    function ec2_action(name, instance_id, state){
        if (state == 'stopped')
        {
            // start
            ec2_start(instance_id);
        }
        else
        {
            // stop
            ec2_stop(name, instance_id);
        }

        // ãƒœã‚¿ãƒ³éè¡¨ç¤º
        this.value = "hoge";
        // this.parentNode.style.display = "none";
    }

    // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç¨®é¡å¤‰æ›´ãƒšãƒ¼ã‚¸ã¸é·ç§»
    function ec2_change_instance_type(instance_id){
        location.href="/aws/change_instance_type?instance_id=" + instance_id;
    }

</script>



</body>

</html>